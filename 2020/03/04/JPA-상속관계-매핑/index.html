
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="동글씨">
    <title>JPA 상속관계 매핑 - 동글씨</title>
    <meta name="author" content="Suyan Kim">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Suyan Kim","sameAs":["https://github.com/ksso730","https://www.instagram.com/syankkim/"],"image":"https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d"},"articleBody":"\n\n\n\n상속관계 매핑논리모델을 실제 물리모델로\n\n조인전략: 각각 테이블로 변환상속관계로 가져옴 item 이 부모(라고 가정) &gt; 자식들(alberm, movie, book)각 자식들은 부모의 id 를 상속받는다.\n\n단일 테이블전략 : 통합 테이블로 변환item 테이블에 모두 들어있음.\n\n구현 클래스마다 : 서브타입 테이블로 변환부모없이, (alberm, movie, book) 각 클래스마다 테이블전략\n\n\n\n\n어노테이션@Inheritance(strategy=InheritanceType. ~~)조인전략: JOINED단일 테이블전략: SINGEL_TABLE각 클래스마다 테이블: TABLE_PER_CLASS\n@DiscriminatorColumn(name=”DTYPE”)컬럼을 구분하기 위한 기능.단일 테이블 전략에서 사용된다. (현재는 추가하지 않아도 자동으로 setting됨)\n@DiscriminatorValue(~~~)\n조인전략장점\n\n테이블 정규화외래키 참조 무결성 제약조건 활용가능저장공간 효율화\n\n단점\n\n조인을 많이 사용, 성능 저하조회 쿼리복잡데이터 저장시 INSERT 2번 호출\n\n여기서 잠깐짚고 넘어가는.. 잊혀진 상식..!\n무결성 제약조건데이터베이스에 들어있는 데이터의 정확성(일관성)을 보장하기 위해 부정확한 자료가 데이터베이스 내에 저장되는 것을 방지하기 위한 제약 조건을 의미함\n\n\n\n무결성의 종류\n설명\n\n\n\n널 무결성\n릴레이션의 특정속성 값이 Null이 될 수 없도록 하는 규정\n\n\n고유 무결성\n릴레이션의 특정 속성에 대해서 각 튜플이 갖는 값들이 서로 달라야 한다는 규정\n\n\n참조 무결성\n외래키 값은 Null이거나 참조 릴레이션의 기본키 값과 동일해야 한다는 규정 즉 릴레이션은 참조할 수 없는 외래키 값을 가질 수 없다는 규정\n\n\n도메인 무결성\n특정 속성의 값이, 그 속성이 정의된 도메인에 속한 값이어야 한다는 규정\n\n\n키 무결성\n하나의 테이블에는 적어도 하나의 키가 존재해야 한다는 규정\n\n\nITEM\n12345678910@Entity@Inheritance(strategy = InheritanceType.JOINED)public class Item &#123;    @Id @GeneratedValue    private Long id;    private  String name;    private int price;&#125;\nMOVIE\n123456@Entitypublic class Movie extends Item &#123;    private String director;    private String actor;&#125;\nALBUM\n1234@Entitypublic class Album extends Item&#123;    private String artist;&#125;\nBOOK\n12345@Entitypublic class Book extends Item &#123;    private String author;    private  String isbn;&#125;\n\n실행해 주면,아래와 같이 테이블 생성이 된다.\n\n\n\n\nmovie 객체 하나를 생성해서 넣어준다.\n1234567Movie movie = new Movie();movie.setDirector(&quot;suyeon&quot;);movie.setActor(&quot;nam&quot;);movie.setName(&quot;바람과함께&quot;);movie.setPrice(10000);em.persist(movie);\n\n아래와 같이 ITEM 을 상속받은 MOVIE 에 ID 가 동일하게 들어갔음을 확인할수 있다.\n\n\n\n단일 테이블 전략설계시 간단한 조건일 경우 많이 사용.단일 테이블 전략은 한 테이블에 모두 밀어넣는 방법!\n장점\n\n조인이 필요없음, 조회성능 빠름조회쿼리가 단순.\n\n단점\n\n자식 엔티티가 매핑한 컬럼은 모두 NULL하나의 테이블에 모두 저장되므로 오히려 느려질 수도 있는 상황 발생우려.\n\n아까 조인전략에서 했던 그대로에서 Items 클래스의 상속전략만 SINGLE_TABLE 로 바꿔준다.\n1234@Inheritance(strategy = InheritanceType.SINGLE_TABLE)public class Items &#123;    ...&#125;\n그리고 다시실행!\n1234567/* insert intelli_mapping.Movie    */ insert     into        Items        (name, price, actor, director, DTYPE, id)     values        (?, ?, ?, ?, &#x27;Movie&#x27;, ?)\n\n조인전략에서는 실행되는 insert 쿼리가 ITems, Movie 두번이었지만단일테이블 전략은 한번 실행되는걸 확인가능하다.\n테이블이 다시 생성되고,하나의 테이블에 모든 데이터가 들어갔다.실행된 query 를 보면 @DiscriminatorColumn 을 추가하지 않았지만,DTYPE 이 자동으로 들어간것을 볼 수 있다.\n123456789101112create table Items (       DTYPE varchar(31) not null,        id bigint not null,        name varchar(255),        price integer not null,        actor varchar(255),        director varchar(255),        author varchar(255),        isbn varchar(255),        artist varchar(255),        primary key (id)    )\n\n\n\n서브타입 테이블로 변환이 방법은 실로 잘 쓰이지 않는다고 한다.각 테이블마다 데이터가 저장되고 조인이 가능한 값이 없어서 ..만약 ITEM_ID 를 조회하고 싶다면, MOVIE, BOOK, ALBUM 세개 테이블을 모두 조회해봐야 한다는 단점이 있다.또한, 추후 DB 변동시에도 수정이 어렵다고 한다.\n12345@Entity@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)public class Items &#123;    ...&#125;\n\nMain은 조인전략과 같이 Movie 에 값을 넣어주도록.실행하면, Moive 에만 값이 입력된다.아무튼 비추라니까 .. 간단하게만 짚고 넘어가자.","dateCreated":"2020-03-04T00:32:57+09:00","dateModified":"2020-04-28T10:36:01+09:00","datePublished":"2020-03-04T00:32:57+09:00","description":"상속관계 매핑을 통해 모델링 전략을 알아봅니다.조인전략, 단일 테이블전략, 구현 클래스마다의 서브테이블로,의 전략.","headline":"JPA 상속관계 매핑","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"},"publisher":{"@type":"Organization","name":"Suyan Kim","sameAs":["https://github.com/ksso730","https://www.instagram.com/syankkim/"],"image":"https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d"}},"url":"http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/","keywords":"jpa"}</script>
    <meta name="description" content="상속관계 매핑을 통해 모델링 전략을 알아봅니다.조인전략, 단일 테이블전략, 구현 클래스마다의 서브테이블로,의 전략.">
<meta property="og:type" content="blog">
<meta property="og:title" content="JPA 상속관계 매핑">
<meta property="og:url" content="http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/index.html">
<meta property="og:site_name" content="동글씨">
<meta property="og:description" content="상속관계 매핑을 통해 모델링 전략을 알아봅니다.조인전략, 단일 테이블전략, 구현 클래스마다의 서브테이블로,의 전략.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://user-images.githubusercontent.com/28856435/75794895-ce9b4480-5db4-11ea-97a9-7151cbffc627.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/28856435/75796170-985ec480-5db6-11ea-9421-cd47c5af54b6.PNG">
<meta property="og:image" content="https://user-images.githubusercontent.com/28856435/75882576-cac6fb00-5e64-11ea-8060-57c9cb79bfe4.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/28856435/75884771-bbe24780-5e68-11ea-84a2-0d168b20c0df.png">
<meta property="article:published_time" content="2020-03-03T15:32:57.000Z">
<meta property="article:modified_time" content="2020-04-28T01:36:01.143Z">
<meta property="article:author" content="Suyan Kim">
<meta property="article:tag" content="jpa">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/28856435/75794895-ce9b4480-5db4-11ea-97a9-7151cbffc627.jpg">
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d?s=640"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-158530470-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-158530470-1');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/index.html"
            aria-label=""
        >
            동글씨
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- function -->


<!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d?s=800" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Suyan Kim</h4>
                
                    <h5 class="sidebar-profile-bio"><p>▲ Who Am I</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             
                                title="home"href="/index.html"
                                
                                >
                    
                    <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">home</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             
                                title="archives"href="/all-archives"
                                
                                >
                    
                    <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">archives</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             
                                title="categories"href="/all-categories"
                                
                                >
                    
                    <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">categories</span>
                        </a>
                    <!-- add -->
                    
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-AWS/">☁️ AWS (0)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Algorithm/">☁️ Algorithm (7)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Config/">☁️ Config (2)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-DataBase/">☁️ DataBase (1)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Git/">☁️ Git (3)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-JPA/">☁️ JPA (10)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Java/">☁️ Java (0)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Linux/">☁️ Linux (6)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Network/">☁️ Network (1)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-OS/">☁️ OS (14)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Python/">☁️ Python (2)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-React/">☁️ React (3)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-Spring/">☁️ Spring (1)</a></li>
                            
                        
                            
                                <li class="side-tag-li"><a class="side-tag" href="/categories/%E2%98%81%EF%B8%8F-TIL/">☁️ TIL (9)</a></li>
                            
                        
                    
                </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             
                                title="tags"href="/all-tags"
                                
                                >
                    
                    <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">tags</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             
                                title="about"href="#about"
                                
                                >
                    
                    <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">about</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/ksso730" target="_blank" rel="noopener" title="github">
                    
                    <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">github</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.instagram.com/syankkim/" target="_blank" rel="noopener" title="life">
                    
                    <i class="sidebar-button-icon fab fa-instagram" aria-hidden="true"></i>
                    <span class="sidebar-button-desc">life</span>
                        </a>
                    <!-- add -->
                    
                </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            JPA 상속관계 매핑
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-03-04T00:32:57+09:00">
	
		    Mar 04, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/%E2%98%81%EF%B8%8F-JPA/">☁️ JPA</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->
<h1 id="table-of-contents">Contents</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91"><span class="toc-text">상속관계 매핑</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%85%BC%EB%A6%AC%EB%AA%A8%EB%8D%B8%EC%9D%84-%EC%8B%A4%EC%A0%9C-%EB%AC%BC%EB%A6%AC%EB%AA%A8%EB%8D%B8%EB%A1%9C"><span class="toc-text">논리모델을 실제 물리모델로</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98"><span class="toc-text">어노테이션</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Inheritance-strategy-InheritanceType"><span class="toc-text">@Inheritance(strategy&#x3D;InheritanceType. ~~)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DiscriminatorColumn-name-%E2%80%9DDTYPE%E2%80%9D"><span class="toc-text">@DiscriminatorColumn(name&#x3D;”DTYPE”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DiscriminatorValue"><span class="toc-text">@DiscriminatorValue(~~~)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%A1%B0%EC%9D%B8%EC%A0%84%EB%9E%B5"><span class="toc-text">조인전략</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%8B%A8%EC%9D%BC-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A0%84%EB%9E%B5"><span class="toc-text">단일 테이블 전략</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%84%9C%EB%B8%8C%ED%83%80%EC%9E%85-%ED%85%8C%EC%9D%B4%EB%B8%94%EB%A1%9C-%EB%B3%80%ED%99%98"><span class="toc-text">서브타입 테이블로 변환</span></a></li></ol></li></ol>

<hr>
<h3 id="상속관계-매핑"><a href="#상속관계-매핑" class="headerlink" title="상속관계 매핑"></a>상속관계 매핑</h3><h4 id="논리모델을-실제-물리모델로"><a href="#논리모델을-실제-물리모델로" class="headerlink" title="논리모델을 실제 물리모델로"></a>논리모델을 실제 물리모델로</h4><p><img src="https://user-images.githubusercontent.com/28856435/75794895-ce9b4480-5db4-11ea-97a9-7151cbffc627.jpg" alt="modeling"></p>
<ol>
<li><p>조인전략: 각각 테이블로 변환<br>상속관계로 가져옴 item 이 부모(라고 가정) &gt; 자식들(alberm, movie, book)<br>각 자식들은 부모의 id 를 상속받는다.</p>
</li>
<li><p>단일 테이블전략 : 통합 테이블로 변환<br>item 테이블에 모두 들어있음.</p>
</li>
<li><p>구현 클래스마다 : 서브타입 테이블로 변환<br>부모없이, (alberm, movie, book) 각 클래스마다 테이블전략</p>
</li>
</ol>
<br/>

<h4 id="어노테이션"><a href="#어노테이션" class="headerlink" title="어노테이션"></a>어노테이션</h4><h5 id="Inheritance-strategy-InheritanceType"><a href="#Inheritance-strategy-InheritanceType" class="headerlink" title="@Inheritance(strategy=InheritanceType. ~~)"></a>@Inheritance(strategy=InheritanceType. ~~)</h5><p>조인전략: <code>JOINED</code><br>단일 테이블전략: <code>SINGEL_TABLE</code><br>각 클래스마다 테이블: <code>TABLE_PER_CLASS</code></p>
<h5 id="DiscriminatorColumn-name-”DTYPE”"><a href="#DiscriminatorColumn-name-”DTYPE”" class="headerlink" title="@DiscriminatorColumn(name=”DTYPE”)"></a>@DiscriminatorColumn(name=”DTYPE”)</h5><p>컬럼을 구분하기 위한 기능.<br>단일 테이블 전략에서 사용된다. (현재는 추가하지 않아도 자동으로 setting됨)</p>
<h5 id="DiscriminatorValue"><a href="#DiscriminatorValue" class="headerlink" title="@DiscriminatorValue(~~~)"></a>@DiscriminatorValue(~~~)</h5><hr>
<h4 id="조인전략"><a href="#조인전략" class="headerlink" title="조인전략"></a>조인전략</h4><p><strong>장점</strong></p>
<blockquote>
<p>테이블 정규화<br><code>외래키 참조 무결성 제약조건</code> 활용가능<br>저장공간 효율화</p>
</blockquote>
<p><strong>단점</strong></p>
<blockquote>
<p>조인을 많이 사용, 성능 저하<br>조회 쿼리복잡<br>데이터 저장시 INSERT 2번 호출</p>
</blockquote>
<p>여기서 잠깐짚고 넘어가는.. 잊혀진 상식..!</p>
<p><strong>무결성 제약조건</strong><br>데이터베이스에 들어있는 데이터의 정확성(일관성)을 보장하기 위해 부정확한 자료가 데이터베이스 내에 저장되는 것을 방지하기 위한 제약 조건을 의미함</p>
<table>
<thead>
<tr>
<th>무결성의 종류</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td>널 무결성</td>
<td>릴레이션의 특정속성 값이 Null이 될 수 없도록 하는 규정</td>
</tr>
<tr>
<td>고유 무결성</td>
<td>릴레이션의 특정 속성에 대해서 각 튜플이 갖는 값들이 서로 달라야 한다는 규정</td>
</tr>
<tr>
<td>참조 무결성</td>
<td>외래키 값은 Null이거나 참조 릴레이션의 기본키 값과 동일해야 한다는 규정 즉 릴레이션은 참조할 수 없는 외래키 값을 가질 수 없다는 규정</td>
</tr>
<tr>
<td>도메인 무결성</td>
<td>특정 속성의 값이, 그 속성이 정의된 도메인에 속한 값이어야 한다는 규정</td>
</tr>
<tr>
<td>키 무결성</td>
<td>하나의 테이블에는 적어도 하나의 키가 존재해야 한다는 규정</td>
</tr>
</tbody></table>
<p><strong>ITEM</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = InheritanceType.JOINED)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>MOVIE</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String director;</span><br><span class="line">    <span class="keyword">private</span> String actor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ALBUM</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Album</span> <span class="keyword">extends</span> <span class="title">Item</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String artist;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>BOOK</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">    <span class="keyword">private</span>  String isbn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>실행해 주면,<br>아래와 같이 테이블 생성이 된다.</p>
<img width="456" alt="h2_item" src="https://user-images.githubusercontent.com/28856435/75796170-985ec480-5db6-11ea-9421-cd47c5af54b6.PNG">

<br/>

<p>movie 객체 하나를 생성해서 넣어준다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Movie movie = <span class="keyword">new</span> Movie();</span><br><span class="line">movie.setDirector(<span class="string">&quot;suyeon&quot;</span>);</span><br><span class="line">movie.setActor(<span class="string">&quot;nam&quot;</span>);</span><br><span class="line">movie.setName(<span class="string">&quot;바람과함께&quot;</span>);</span><br><span class="line">movie.setPrice(<span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">em.persist(movie);</span><br></pre></td></tr></table></figure>

<p>아래와 같이 ITEM 을 상속받은 MOVIE 에 ID 가 동일하게 들어갔음을 확인할수 있다.<br><img src="https://user-images.githubusercontent.com/28856435/75882576-cac6fb00-5e64-11ea-8060-57c9cb79bfe4.png" alt="image"></p>
<br/>

<hr>
<h4 id="단일-테이블-전략"><a href="#단일-테이블-전략" class="headerlink" title="단일 테이블 전략"></a>단일 테이블 전략</h4><p>설계시 간단한 조건일 경우 많이 사용.<br>단일 테이블 전략은 한 테이블에 모두 밀어넣는 방법!</p>
<p><strong>장점</strong></p>
<blockquote>
<p>조인이 필요없음, 조회성능 빠름<br>조회쿼리가 단순.</p>
</blockquote>
<p><strong>단점</strong></p>
<blockquote>
<p>자식 엔티티가 매핑한 컬럼은 모두 NULL<br>하나의 테이블에 모두 저장되므로 오히려 느려질 수도 있는 상황 발생우려.</p>
</blockquote>
<p>아까 조인전략에서 했던 그대로에서 Items 클래스의 상속전략만 <code>SINGLE_TABLE</code> 로 바꿔준다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inheritance(strategy = InheritanceType.SINGLE_TABLE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Items</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>그리고 다시실행!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/* insert intelli_mapping.Movie</span><br><span class="line">    */ insert </span><br><span class="line">    into</span><br><span class="line">        Items</span><br><span class="line">        (name, price, actor, director, DTYPE, id) </span><br><span class="line">    values</span><br><span class="line">        (?, ?, ?, ?, <span class="string">&#x27;Movie&#x27;</span>, ?)</span><br></pre></td></tr></table></figure>

<p>조인전략에서는 실행되는 insert 쿼리가 ITems, Movie 두번이었지만<br>단일테이블 전략은 한번 실행되는걸 확인가능하다.</p>
<p>테이블이 다시 생성되고,<br>하나의 테이블에 모든 데이터가 들어갔다.<br>실행된 query 를 보면 <code>@DiscriminatorColumn</code> 을 추가하지 않았지만,<br><code>DTYPE</code> 이 자동으로 들어간것을 볼 수 있다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create table Items (</span><br><span class="line">       DTYPE varchar(31) not null,</span><br><span class="line">        id bigint not null,</span><br><span class="line">        name varchar(255),</span><br><span class="line">        price <span class="built_in">integer</span> not null,</span><br><span class="line">        actor varchar(255),</span><br><span class="line">        director varchar(255),</span><br><span class="line">        author varchar(255),</span><br><span class="line">        isbn varchar(255),</span><br><span class="line">        artist varchar(255),</span><br><span class="line">        primary key (id)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/28856435/75884771-bbe24780-5e68-11ea-84a2-0d168b20c0df.png" alt="image"></p>
<br/>

<h4 id="서브타입-테이블로-변환"><a href="#서브타입-테이블로-변환" class="headerlink" title="서브타입 테이블로 변환"></a>서브타입 테이블로 변환</h4><p>이 방법은 실로 잘 쓰이지 않는다고 한다.<br>각 테이블마다 데이터가 저장되고 조인이 가능한 값이 없어서 ..<br>만약 ITEM_ID 를 조회하고 싶다면, MOVIE, BOOK, ALBUM 세개 테이블을 모두 조회해봐야 한다는 단점이 있다.<br>또한, 추후 DB 변동시에도 수정이 어렵다고 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Items</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Main은 조인전략과 같이 Movie 에 값을 넣어주도록.<br>실행하면, Moive 에만 값이 입력된다.<br>아무튼 비추라니까 .. 간단하게만 짚고 넘어가자.</p>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/jpa/" rel="tag">jpa</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/03/04/JPA-%EA%B3%B5%ED%86%B5-%EB%A7%A4%ED%95%91%EC%A0%95%EB%B3%B4-%EC%82%AC%EC%9A%A9/"
                    data-tooltip="JPA 공통 매핑정보 사용"
                    aria-label="PREVIOUS: JPA 공통 매핑정보 사용"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/02/29/Python-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1-py-%EC%8B%A4%ED%96%89/"
                    data-tooltip="Python 가상환경 구성, 장고 프로젝트"
                    aria-label="NEXT: Python 가상환경 구성, 장고 프로젝트"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 Suyan Kim. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/03/04/JPA-%EA%B3%B5%ED%86%B5-%EB%A7%A4%ED%95%91%EC%A0%95%EB%B3%B4-%EC%82%AC%EC%9A%A9/"
                    data-tooltip="JPA 공통 매핑정보 사용"
                    aria-label="PREVIOUS: JPA 공통 매핑정보 사용"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/02/29/Python-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1-py-%EC%8B%A4%ED%96%89/"
                    data-tooltip="Python 가상환경 구성, 장고 프로젝트"
                    aria-label="NEXT: Python 가상환경 구성, 장고 프로젝트"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/221eb22c21ff8475b8c63271e349b77d?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Suyan Kim</h4>
        <!--  -->
            <!-- <div id="about-card-bio"><p>author.bio</p>
</div> -->
            <div id="about-card-bio">안녕하세요, 서버 백엔드 개발자 동글씨입니다.</div>
        <!--  -->
        <!--  -->
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <!-- <p>Backend Developer</p>
 -->
                Backend Developer
            </div>
        <!--  -->
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Korea
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/null');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'http://yoursite.com/2020/03/04/JPA-%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/';
              
            this.page.identifier = '2020/03/04/JPA-상속관계-매핑/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'ksso730-github-io';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
